<!DOCTYPE html>
<html>
<head>
  <title>Google Service Account Setup Guide</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      color: #333;
    }
    h1 {
      color: #4285F4;
      border-bottom: 2px solid #4285F4;
      padding-bottom: 10px;
    }
    h2 {
      color: #34A853;
      margin-top: 30px;
    }
    .step {
      background-color: #f8f9fa;
      border-left: 4px solid #4285F4;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 0 4px 4px 0;
    }
    code {
      background-color: #eeeeee;
      padding: 2px 4px;
      border-radius: 3px;
      font-family: monospace;
    }
    img {
      max-width: 100%;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin: 15px 0;
    }
    .note {
      background-color: #FFF9C4;
      padding: 10px;
      border-left: 4px solid #FBC02D;
      margin-bottom: 20px;
      border-radius: 0 4px 4px 0;
    }
    a {
      color: #4285F4;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .button {
      display: inline-block;
      background-color: #4285F4;
      color: white;
      padding: 10px 15px;
      border-radius: 4px;
      margin-top: 20px;
      text-decoration: none;
    }
    .button:hover {
      background-color: #3367d6;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <h1>Google Service Account Setup Guide</h1>
  
  <div class="note">
    <strong>Note:</strong> You mentioned that you already have a service account created. This guide will help you enable the necessary APIs and create a key for your service account.
  </div>
  
  <h2>Step 1: Enable Required Google APIs</h2>
  <div class="step">
    <ol>
      <li>Go to the <a href="https://console.cloud.google.com/apis/library" target="_blank">Google Cloud Console API Library</a></li>
      <li>Make sure you're signed in with the correct Google account</li>
      <li>Search for and enable the following APIs:
        <ul>
          <li>Google Sheets API</li>
          <li>Google Drive API</li>
        </ul>
      </li>
    </ol>
  </div>

  <h2>Step 2: Create a Service Account Key</h2>
  <div class="step">
    <ol>
      <li>Go to <a href="https://console.cloud.google.com/iam-admin/serviceaccounts" target="_blank">Service accounts</a> in the Google Cloud Console</li>
      <li>Select your project</li>
      <li>Find your existing service account and click on it</li>
      <li>Go to the "Keys" tab</li>
      <li>Click "Add Key" and select "Create new key"</li>
      <li>Choose "JSON" as the key type</li>
      <li>Click "Create"</li>
      <li>The key file will be automatically downloaded to your computer</li>
    </ol>
  </div>

  <h2>Step 3: Configure n8n with Service Account Key</h2>
  <div class="step">
    <ol>
      <li>In n8n, create a new credential for Google Sheets</li>
      <li>Select "Service Account" as the authentication method</li>
      <li>Open the downloaded JSON key file in a text editor</li>
      <li>Copy the entire contents of the file</li>
      <li>Paste the contents into the "Service Account" field in n8n</li>
      <li>Click "Save" to create the credential</li>
    </ol>
  </div>

  <div class="note">
    <strong>Important:</strong> For Google Sheets specifically, you'll need to share any sheets you want to access with the service account email address (found in the JSON file as "client_email").
  </div>

  <h2>Troubleshooting</h2>
  <div class="step">
    <ul>
      <li><strong>Access Issues:</strong> Make sure you've shared your Google Sheets with the service account email</li>
      <li><strong>API Errors:</strong> Verify that all required APIs are enabled for your project</li>
      <li><strong>Authentication Failures:</strong> Ensure the entire JSON key is copied correctly</li>
      <li><strong>Scope Issues:</strong> If you're getting permission errors, you may need to enable additional APIs</li>
    </ul>
  </div>

  <a href="https://docs.n8n.io/integrations/credentials/google/" class="button" target="_blank">n8n Google Credentials Documentation</a>
  
  <script>
    // JavaScript could be added here for interactivity if needed
  </script>
</body>
</html> 